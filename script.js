const properties = {
  "ECO (888)": {
    name: "ECO (888)",
    type: "Studio Unit",
    location: "69 Matahimik Street Riverside 2 Subdivision Brgy. Sto. Domingo Cainta, Rizal.",
    contracts: [
      "5,399 PER MONTH 1 YEAR CONTRACT.<br> 1 MONTH ADVANCE 2 MONTHS DEPOSIT.",
      "5,899 PER MONTH 6 MONTHS CONTRACT.<br> 1 MONTH ADVANCE 2 MONTHS DEPOSIT.",
      "6,298 PER MONTH 3 MONTHS CONTRACT (3000) UTILITY DEPOSIT.",
      "6,888 PER MONTH MONTHL CONTRACT 1 MONTH ADVANCE.",
    ],
    landmark:`Boundary of Pasig and Cainta. Walking distance to Ortigas Extension & Robinson's (Big R) Cainta Junction. Near the business district of Ortigas, Makati, Eastwood and Cubao.<br>
    <a href="https://maps.app.goo.gl/ZtoYCfw6VS1Q2Tiy7" target="_blank" class="text-blue-600 underline">Google Map</a>`,
  },
  "ADI 168": {
    name: "ADI 168",
    type: "Semi-furnished unit",
    location: "Lt. 6 Blk. 15 Kayumangi St. Karangalan Village, San Isidro Cainta, Rizal",
    contracts: [
      "Trial - 3,999 - 1 MONTH - 1k utility DEPOSIT",
      "3,999 PER MONTH - 6 MONTH CONTRACT - 1 MONTH ADVANCE 1 MONTH DEPOSIT"
    ],
    landmark: `Walking distance to LRT Marikina-Pasig Station. Near the business district of Cubao, Ortigas, Makati, and Eastwood.<br>
    <a href="https://maps.app.goo.gl/EQkAxPWgDAhyknM79" target="_blank" class="text-blue-600 underline">Google Map</a>`,
  },
  "BED AND BATH": {
    name: "Bed and Bath",
    type: "Bedspace unit",
    location: "74 Monaco St, Ciudad Grande 2, Pasig City, 1611 Metro Manila",
    contracts: [
      "299 - Daily Minimum of 3 days stay.",
      "1 MONTH TRIAL -(Lower bed: 2,200, Upper bed: 1,999)",
      "Extended 1 month trial (Lower bed: 2,500, Upper bed: 2,300)",
      "3,100 - MONTHLY CONTRACT",
    ],
    landmark: `One ride to Ortigas, Mandaluyong, Makati, Eastwood, Libis, and BGC. Walking distance to SM East Ortigas, Super 8 Grocery, McDonald's, and major banks. Near: The Medical City, Mission Hospital, UA&P, St. Paul College of Pasig, Ateneo School of Medicine.<br>
    <a href="https://maps.app.goo.gl/hphkFhzp1XebbM849" target="_blank" class="text-blue-600 underline">Google Map</a>`,
  },
  "DREAM": {
    name: "DREAM",
    type: "Studio Unit",
    location: "80 Monaco St. Cuidad Grande 2, Ortigas Extension Pasig City.",
    contracts: [
      "1 BEDROOM - 10,200 PER MONTH - 1 YEAR CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "10,700 PER MONTH - 6 MONTHS CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "11,200 PER MONTH - MONTHLY CONTRACT - 3000 UTILITY DEPOSIT",
      "1,000 - DAILY RENTAL",
      "2 BEDROOMS - 12,400 PER MONTH - 1 YEAR CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "12,900 PER MONTH - 6 MONTHS CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "13,400 - MONTHLY - 3K UTILITY DEPOSIT",
      "1,000 - DAILY",
      "STUDIO - 7900 PER MONTH - 1 YEAR CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "8,400 PER MONTH - 6 MONTHS CONTACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "8,900 PER MONTH - MONTHLY CONTRACT - 3K UTILITY DEPOSIT",
      "Studio unit",
      "700 - DAILY"
    ],
    landmark: `Walking distance from SM East Ortigas. Near business districts of Ortigas, Makati, BGC, Eastwood, Cubao, and Marikina.<br>
    <a href="https://maps.app.goo.gl/AP35c9sccbpSmaqU8" target="_blank" class="text-blue-600 underline">Google Map</a>`,
  },
  "PLEASANT": {
    name: "PLEASANT",
    type: "Studio unit",
    location: "Mt. Plesant St. Brgy. Sta. Elena Marikina City",
    contracts: [
      "1A TO 1E - 4,999 PER MONTH - 1 YR CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "5,400 PER MONTH - 6 MONTHS CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "5,999 - MONTHLY CONTRACT - 3K UTILITY DEPOSIT",
      "700 - DAILY",
      "UNIT 1F, 2L, 3R, AND 4X - 5099 PER MONTH - 1 YR CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "5,599 PER MONTH - 6 MONTHS CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "6,099 - MONTHLY CONTRACT - 3K UTILITY DEPOSIT"
    ], 
    landmark:`Near LRT Line 2 Marikina-Pasig Station 1 ride to Cubao, Makati, Ortigas, Eastwood, and Manila. Walking distance to Marikina Public Market, Amang Rodriguez Hospital, Blue Wave, Marikina Sports Center, and more.<br>
    <a href="https://maps.app.goo.gl/5D3Ke41BDTLFLHPh9" target="_blank" class="text-blue-600 underline">Google Map</a>`,
  },
  "HOMEY": {
    name: "HOMEY",
    type: "Bedroom unit",
    location: "Lot 1 Block. 3 Kanlaon St., DM 5, Cainta, Rizal",
    contracts: [
      "1ST FLOOR FRONT STUDIO - 3,999 PER MONTH - 1 YEAR CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "2ND FLOOR 1 BEDROOM - 6,000 PER MONTH - 1 YR CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "3,4,5 - 5500 PER MONTH - 1 YEAR CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "#2 - 6,000 PER MONTH - 1 YEAR CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "6,7,8 - 6,000 PER MONTH – 1 YEAR CONTRACT W/ AC PROVISION - 1 MONTH ADVANCE 2 MONTHS DEPOSIT"
    ],
    landmark: `Just minutes away from Cainta Municipal Hall, SM Savemore, Puregold, churches, wet & dry markets. Accessible routes to Ortigas Extension (via Midtown Village–De Castro/Countryside Exit), C6, BGC, Taguig, and Pasig.<br>
    <a href="https://maps.app.goo.gl/VnyT7tHi4QXXRHXj9" target="_blank" class="text-blue-600 underline">Google Map</a>`,
  },
  "KALAYAAN 888": {
    name: "KALAYAAN 888",
    type: "Studio unit",
    location: "Karangalan Gate 1 Kalayaan St. San Isidro Cainta, Rizal",
    contracts: [
      "4,999 PER MONTH - 1 MONTH ADVANCE 2 MONTH DEPOSITS"
    ],
    landmark: `Walking distance to McDonald's, and Jollibee Karangalan Gate 1 Cainta, Rizal. Near the business district of Eastwood, Ortigas, Makati, BGC, and Quezon City.<br>
    <a href="https://maps.app.goo.gl/Af2TLxWQywnufPVf7" target="_blank" class="text-blue-600 underline">Google Map</a>`,
  },
  "PENTHAUZ": {
    name: "PENTHAUZ",
    type: "Studio unit",
    location: "80 Monaco St. Pasig City",
    contracts: [
      "7,999 to 8,500/month"
    ],
    landmark: `Walking distance from SM East Ortigas. Near business districts of Ortigas, Makati, BGC, Eastwood, Cubao, and Marikina.<br>
    <a href="https://maps.app.goo.gl/AP35c9sccbpSmaqU8" target="_blank" class="text-blue-600 underline">Google Map</a>`,
  },
  "GREEN": {
    name: "GREEN",
    type: "Studio unit",
    location: "Malinis S. Brgy. Sto Domingo Cainta, 1900 Rizal",
    contracts: [
      "5,799 PER MONTH - UPPER UNIT - 1 YR CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT",
      "5,399 PER MONTH - LOWER UNIT - 1 YR CONTRACT - 1 MONTH ADVANCE 2 MONTHS DEPOSIT"
    ],
    landmark: `Walking distance to Ortigas Extension, Robinson's (Big R) Cainta Junction, and the business district of Ortigas, Makati, Eastwood, and Cubao.`,
  }
};

// Input Elements
const locationInput = document.getElementById("locationInput");
const typeInput = document.getElementById("typeInput");
const landmarkInput = document.getElementById("landmarkInput");
const results = document.getElementById("results");

let debounceTimer;

function triggerSearch() {
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(() => {
    search(
      locationInput.value.trim().toLowerCase(),
      typeInput.value.trim().toLowerCase(),
      landmarkInput.value.trim().toLowerCase()
    );
  }, 300);
}

[locationInput, typeInput, landmarkInput].forEach(input => {
  input.addEventListener("input", triggerSearch);
  input.addEventListener("keyup", e => {
    if (e.key === "Enter") triggerSearch();
  });
});

function highlightKeywords(text, keyword) {
  if (!text || !keyword) return text;
  const regex = new RegExp(`(${keyword})`, "gi");
  return text.replace(regex, "<strong class='text-lime-600'>$1</strong>");
}

function search(locationKeyword, typeKeyword, landmarkKeyword) {
  // Do not display anything if all inputs are empty
  if (!locationKeyword && !typeKeyword && !landmarkKeyword) {
    results.innerHTML = "";
    return;
  }

  let resultTables = "";
  let matchFound = false;

  for (const [_, data] of Object.entries(properties)) {
    const matchesLocation = locationKeyword === "" ||
      data.location.toLowerCase().includes(locationKeyword);

    const matchesType = typeKeyword === "" ||
      data.type.toLowerCase().includes(typeKeyword);

    const matchesLandmark = landmarkKeyword === "" ||
      (data.landmark || "").toLowerCase().includes(landmarkKeyword);

    if (matchesLocation && matchesType && matchesLandmark) {
      matchFound = true;

      const table = document.createElement("table");
      table.className =
        "min-w-full bg-white text-sm text-left text-gray-600 shadow rounded overflow-hidden mb-8";

      const thead = `
        <thead class="bg-lime-500 text-white">
          <tr>
            <th class="px-4 py-3 text-center">Property</th>
            <th class="px-4 py-3 text-center">Type</th>
            <th class="px-4 py-3 text-center">Location</th>
            <th class="px-4 py-3 text-center">Details</th>
            <th class="px-4 py-3 text-center">Landmark</th>
          </tr>
        </thead>
      `;

      const tbody = data.contracts
        .map(contract => `
          <tr class="border-b hover:bg-gray-50">
            <td class="px-4 py-2 font-bold">${highlightKeywords(data.name, locationKeyword)}</td>
            <td class="px-4 py-2">${highlightKeywords(data.type, typeKeyword)}</td>
            <td class="px-4 py-2">${highlightKeywords(data.location, locationKeyword)}</td>
            <td class="px-4 py-2">${contract}</td>
            <td class="px-4 py-2">${highlightKeywords(data.landmark || "", landmarkKeyword)}</td>
          </tr>
        `)
        .join("");

      table.innerHTML = thead + `<tbody>${tbody}</tbody>`;
      resultTables += table.outerHTML;
    }
  }

  results.innerHTML = matchFound
    ? resultTables
    : '<div class="text-center text-gray-500 mt-4">No matching properties found.</div>';
}
